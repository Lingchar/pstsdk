[
  {
    "Id": "465370",
    "ThreadId": "218908",
    "Html": "<p>Hi,</p>\r\n<p>I wrote a simple program to read pst using sdk as:</p>\r\n<p>// pst_sdk_8_4.43.cpp : Defines the entry point for the console application.//</p>\r\n<p>#include &lt;iostream&gt;</p>\r\n<p>#include &lt;iomanip&gt;</p>\r\n<p>#include &lt;string&gt;</p>\r\n<p>#include &lt;vector&gt;</p>\r\n<p>#include &quot;stdafx.h&quot;</p>\r\n<p>#include &quot;pst.h&quot;</p>\r\n<p>using namespace std;</p>\r\n<p>using namespace pstsdk;</p>\r\n<p>pstsdk::pst sample(L&quot;submessage.pst&quot;);</p>\r\n<p>void Ado_stuff(attachment&amp; attach);</p>\r\n<p>void Mdo_stuff(message&amp; m);</p>\r\n<p>void do_stuff(folder&amp; fold);</p>\r\n<p>class E {</p>\r\n<p>public:</p>\r\n<p>const char* error;</p>\r\n<p>E(</p>\r\n<p>const char* arg) : error(arg) { }</p>\r\n<p>};</p>\r\n<p>void Mdo_stuff(message&amp; m){</p>\r\n<p>try</p>\r\n<p>{</p>\r\n<p>wstring subject = m.get_subject();</p>\r\n<p>wstring body = m.get_body();</p>\r\n<p>wstring htmlbody = m.get_html_body();</p>\r\n<p>prop_stream bodystream(m.open_body_stream());</p>\r\n<p>prop_stream htmlbodystream(m.open_html_body_stream());</p>\r\n<p>size_t num_attachments = m.get_attachment_count();</p>\r\n<p>size_t num_recipients = m.get_recipient_count();</p>\r\n<p>std::wcout &lt;&lt; L&quot;subject[&quot; &lt;&lt; subject&lt;&lt; L']' &lt;&lt; std::endl;</p>\r\n<p>std::wcout &lt;&lt; L&quot;body[&quot; &lt;&lt; body&lt;&lt; L']' &lt;&lt; std::endl;</p>\r\n<p>if(m.get_attachment_count()&gt; 0){</p>\r\n<p>for(message::attachment_iterator iter = m.attachment_begin(); iter != m.attachment_end(); ++iter){</p>\r\n<p>Ado_stuff(*iter);</p>\r\n<p>// *iter is an attachment on this message}</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>catch (E&amp; e) {</p>\r\n<p>cout &lt;&lt; e.error &lt;&lt; endl;</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>void&nbsp;Ado_stuff(attachment&amp; attach){</p>\r\n<p>try</p>\r\n<p>{</p>\r\n<p>wstring filename = attach.get_filename();</p>\r\n<p>std::wcout &lt;&lt; L&quot;attachment_name[&quot; &lt;&lt; filename&lt;&lt; L']' &lt;&lt; std::endl;vector&lt;byte&gt; content = attach.get_bytes();</p>\r\n<p>prop_stream content_stream(attach.open_byte_stream());</p>\r\n<p>std::wstring wfilename = attach.get_filename();</p>\r\n<p>std::string filename1(wfilename.begin(), wfilename.end());</p>\r\n<p>ofstream newfile(filename.c_str(), ios::out | ios::binary);</p>\r\n<p>newfile &lt;&lt; attach;</p>\r\n<p>if(attach.is_message()){</p>\r\n<p>message m = attach.open_as_message();</p>\r\n<p>// throws bad_cast if is_message() == falseMdo_stuff(m);</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>catch (E&amp; e) {</p>\r\n<p>cout &lt;&lt; e.error &lt;&lt; endl;</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>void</p>\r\n<p>do_stuff(folder&amp; fold){</p>\r\n<p>try</p>\r\n<p>{</p>\r\n<p>std::wcout &lt;&lt; L</p>\r\n<p>&quot;folder[&quot; &lt;&lt; fold.get_name()&lt;&lt; L']' &lt;&lt; std::endl;</p>\r\n<p>for(folder::message_iterator iter = fold.message_begin(); iter != fold.message_end();iter++){</p>\r\n<p>Mdo_stuff(*iter);</p>\r\n<p>// *iter is a message in this folder}</p>\r\n<p>}</p>\r\n<p>catch (E&amp; e){</p>\r\n<p>cout &lt;&lt; e.error &lt;&lt; endl;</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>int</p>\r\n<p>main(int argc, _TCHAR* argv[]){</p>\r\n<p>try</p>\r\n<p>{</p>\r\n<p>/*folder fold = sample.open_root_folder();*/</p>\r\n<p>for(pst::folder_iterator iter = sample.folder_begin(); iter != sample.folder_end();++iter){</p>\r\n<p>do_stuff(*iter);</p>\r\n<p>}</p>\r\n<p>cin.get();</p>\r\n<p>return 0;}</p>\r\n<p>catch (E&amp; e){</p>\r\n<p>cout &lt;&lt; e.error &lt;&lt; endl;</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n<p>when i run this it breaks and gives the error &quot;<span style=\"color:#ff0000\"><strong>Unhandled exception at 0x7c812afb in pst_sdk_8_4.43.exe: Microsoft C++ exception: pstsdk::key_not_found&lt;unsigned short&gt; at memory location 0x0012eaf0..&quot; which points to file btree.h</strong></span></p>\r\n<p>when i click continue then the output is same as expected,no problem with it.I am unable to identify why this break is coming and how to remove it.Any help regarding this woud be thankful.</p>\r\n<p>**I am using visual studio2008 and boost 42 and pstsdk's latest version&nbsp;for the project</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-07-09T06:14:08.12-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "465507",
    "ThreadId": "218908",
    "Html": "<p>key_not_found is thrown whenever you try to lookup a property which doesn't exist on the item. For example, calling get_html_body() on a message object could throw this exception if the message doesn't have an HTML body.</p>\r\n<p>Visual Studio should give you a callstack of where the exception is being thrown (specifically, what call).</p>",
    "PostedDate": "2010-07-09T09:55:09.63-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  }
]